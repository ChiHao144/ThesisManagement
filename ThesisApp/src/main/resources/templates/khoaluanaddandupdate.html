<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Quản lý khóa luận</title>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
        <link href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css"
              rel="stylesheet"/>

        <style>
            .select2-container--bootstrap-5 .select2-search--dropdown {
                padding: 0;
                border-bottom: none;
            }

            .select2-container--bootstrap-5 .select2-search--dropdown .select2-search__field {
                border: none;
                border-radius: 0;
                padding: 0.5rem 0.75rem;
                font-size: 1rem;
                width: 100%;
                box-sizing: border-box;
            }

            .select2-container--bootstrap-5 .select2-dropdown {
                border: 1px solid #80bdff;
                box-shadow: none;
                border-radius: 0.375rem;
                overflow: hidden;
                background-color: #fff; /* Đảm bảo nền trắng */
            }
        </style>
    </head>
    <body>
        <div th:replace="base :: header"></div>

        <main class="container mt-4">
            <h1 class="text-center text-info mb-4">QUẢN LÝ KHÓA LUẬN</h1>

            <form th:action="@{/khoaluans/save}" method="post" th:object="${khoaluan}" class="bg-white p-4 shadow rounded">
                <div th:if="${errorMessage}" class="alert alert-danger">
                    <p th:text="${errorMessage}"></p>
                </div>
                <div class="mb-3">
                    <label class="form-label">Chủ đề</label>
                    <input type="text" class="form-control" th:field="*{chuDe}" required/>
                </div>

                <div class="mb-3">
                    <label class="form-label">Sinh viên thực hiện</label>
                    <select class="form-select js-sinhvien-select" th:field="*{sinhVienId.id}">
                        <option value="">-- Chọn sinh viên --</option>
                        <option th:each="sv : ${sinhViens}"
                                th:value="${sv.id}"
                                th:text="${sv.id + ' - ' + sv.user.fullname}"></option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Giảng viên hướng dẫn 1</label>
                    <select class="form-select js-giangvien-select" th:field="*{gvhd1.id}">
                        <option value="">-- Chọn giảng viên --</option>
                        <option th:each="gv : ${giangViens}"
                                th:value="${gv.id}"
                                th:text="${gv.id + ' - ' + gv.user.fullname}"></option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Giảng viên hướng dẫn 2 (nếu có)</label>
                    <select class="form-select js-giangvien-select" th:field="*{gvhd2.id}">
                        <option value="">-- Không có --</option>
                        <option th:each="gv : ${giangViens}"
                                th:value="${gv.id}"
                                th:text="${gv.id + ' - ' + gv.user.fullname}"></option>
                    </select>
                </div>

                <div class="mb-3" >
                    <label class="form-label">Hội đồng</label>
                    <select class="form-select js-hoidong-select" th:field="*{hoidongId.id}">
                        <option value="">-- Chọn hội đồng --</option>
                        <option th:each="hd : ${hoiDongs}"
                                th:value="${hd.id}"
                                th:text="${hd.id + ' - ' + hd.noiDungBaoVe}"></option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Giảng viên phản biện</label>
                    <select class="form-select js-giangvien-select" th:field="*{gvpb.id}">
                        <option value="">-- Chọn giảng viên phản biện --</option>
                        <option th:each="gv : ${giangViens}"
                                th:value="${gv.id}"
                                th:text="${gv.id + ' - ' + gv.user.fullname}"></option>
                    </select>
                </div>

                <input type="hidden" th:field="*{id}"/>

                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-success">
                        <span th:if="${khoaluan.id == null}">Thêm khóa luận</span>
                        <span th:if="${khoaluan.id != null}">Cập nhật khóa luận</span>
                    </button>
                    <a th:href="@{/khoaluans}" class="btn btn-secondary">Hủy</a>
                </div>
            </form>
        </main>

        <div th:replace="base :: footer"></div>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

        <script>
            $(document).ready(function () {
                $('.js-sinhvien-select').select2({
                    placeholder: 'Nhập mã hoặc tên sinh viên...',
                    allowClear: true,
                    width: '100%',
                    theme: 'bootstrap-5'
                });

                $('.js-giangvien-select').select2({
                    placeholder: 'Nhập mã hoặc tên giảng viên...',
                    allowClear: true,
                    width: '100%',
                    theme: 'bootstrap-5'
                });

                $('.js-hoidong-select').select2({
                    placeholder: 'Nhập mã hoặc nội dung bảo vệ...',
                    allowClear: true,
                    width: '100%',
                    theme: 'bootstrap-5'
                });
            });
        </script>
    </body>
</html>